<!DOCTYPE html>
<html>
    <head>
        <title>docs : Testing</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">docs</a></span>
                            </li>
                                                    <li>
                                <span><a href="163927.html">IT Project Group 043: Moist Blast documentation</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            docs : Testing
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Luca Gonzalez</span>, last modified by <span class='editor'> Keigo Nagai</span> on Nov 10, 2022
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <div class="table-wrap"><table data-layout="default" data-local-id="92002720-1996-4f4f-a815-586170f02d14" class="confluenceTable"><colgroup><col style="width: 170.0px;"/><col style="width: 170.0px;"/><col style="width: 170.0px;"/><col style="width: 170.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Version</strong></p></th><th class="confluenceTh"><p><strong>Published</strong></p></th><th class="confluenceTh"><p><strong>Changed By</strong></p></th><th class="confluenceTh"><p><strong>Comment</strong></p></th></tr><tr><td class="confluenceTd"><p>v1</p></td><td class="confluenceTd"><p>22/09/22</p></td><td class="confluenceTd"><p>Keigo Nagai</p></td><td class="confluenceTd"><p>Documented used testing frameworks and noteworthy decisions</p></td></tr><tr><td class="confluenceTd"><p>v2</p></td><td class="confluenceTd"><p>23/09/22</p></td><td class="confluenceTd"><p>Keigo Nagai</p></td><td class="confluenceTd"><p>Additional comments on how to run cypress tests in development.</p></td></tr><tr><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr></tbody></table></div><p>The use of Firebase and NextJS allows us to effortlessly create a full-stack application without the need to write extensive APIs and back-end code for a small-scale web application. Therefore, our team of developers will create and run End-to-end and Integration tests per user story/acceptance criteria/JIRA ticket. Cypress will be testing framework which makes front-end and back-end testing on web application easier for us.</p><h2 id="Testing-Cypress-https://www.cypress.io/">Cypress - <a class="external-link" data-card-appearance="inline" href="https://www.cypress.io/" rel="nofollow">https://www.cypress.io/</a> </h2><p>A framework that enables us to easily create end-to-end and component tests on our react project.</p><p>The tests will produce artifacts (screenshots/videos) that will aid in visualizing the testing procedure and any potential problems.</p><p>Articles on best practices for writing Cypress tests:</p><ul><li><p><a class="external-link" data-card-appearance="inline" href="https://docs.cypress.io/guides/references/best-practices" rel="nofollow">https://docs.cypress.io/guides/references/best-practices</a> </p></li><li><p><a class="external-link" data-card-appearance="inline" href="https://www.youtube.com/watch?v=5XQOK0v_YRE" rel="nofollow">https://www.youtube.com/watch?v=5XQOK0v_YRE</a> </p></li></ul><h2 id="Testing-Firebase">Firebase</h2><h3 id="Testing-cypress-firebase:BypassFirebaseAuthentication"><a class="external-link" href="https://github.com/prescottprue/cypress-firebase" rel="nofollow">cypress-firebase</a>: Bypass Firebase Authentication</h3><p>Firebase is simple to setup a secure and authenticated web server back-end, however it has it down sides when it comes to flexibility. When testing with Cypress on functionalities that heavily tie in with firebase services, the testing instance is not given permission to read or write data. We use a library provided by <a class="external-link" href="https://github.com/prescottprue" rel="nofollow">Scott Prue</a> in order to bypass this problem. </p><h3 id="Testing-FirebaseEmulators:Setuptestingbackendservices"><a class="external-link" href="https://firebase.google.com/docs/emulator-suite" rel="nofollow">Firebase Emulators</a>: Set up testing backend services</h3><p>Firebase does not provide services to create testing environments for our database, authentication, storage and cloud functions, therefore, an emulated firebase server is run locally to separate production and testing environments. </p><h2 id="Testing-WritingTests">Writing Tests</h2><p>Tests are written and stored in <code>app/cypress</code> directory.</p><p>Refer to official documentation for writing Cypress tests.</p><p><a class="external-link" data-card-appearance="inline" href="https://docs.cypress.io/guides/overview/why-cypress" rel="nofollow">https://docs.cypress.io/guides/overview/why-cypress</a> </p><h2 id="Testing-HowtoTest(indevmode)">How to Test (in dev mode)</h2><ul><li><p>Ensure Firebase CLI is installed on your machine. - <a class="external-link" data-card-appearance="inline" href="https://firebase.google.com/docs/cli" rel="nofollow">https://firebase.google.com/docs/cli</a> </p></li><li><p>Head to the Firebase <a class="external-link" href="https://console.firebase.google.com/u/0/project/shitimes-f199b/overview" rel="nofollow">Project console</a> → Project Settings → Service Accounts → Firebase Admin SDK → Generate new Private Key.</p></li><li><p>Save the json file into the <code>app</code> directory as <code>serviceAccount.json</code> (make sure it is not pushed to the remote git repository).</p></li><li><p>Ensure all dependencies (run <code>npm i</code>) are installed in <code>app/functions</code> directory and build with <code>npm run build</code></p></li></ul><p>1. Navigate to <code>app/functions</code> file and export .runtimeconfig.json to retrieve runtime env variables.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">cd app/functions
firebase functions:config:get &gt; .runtimeconfig.json</pre>
</div></div><p>2. Navigate to app directory, and run Node in the development environment (with emulator).</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">cd app
npm run dev:emulator</pre>
</div></div><p>3. After dev build compiles and runs, open a new terminal and run test script with emulators. (Keep terminal with dev build running).</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">// Run tests on emulator head-lessly (without Cypress UI)
npm run test:emulate-run

// Open Cypress testing UI with emulated server
npm run test:emulate-open</pre>
</div></div><p>3. Cypress UI will install/open up to then run E2E/Component tests that are stored in app/cypress/ directory.</p><p>The tests will run on emulated firebase servers, which will not affect the firebase services (database, authentication and functions) for production. Scripts are written so that npm run dev</p><p />
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jan 25, 2023 09:57</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
